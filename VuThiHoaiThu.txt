BÀI 1:

create database Qlthuctap_VuThiHoaiThu
use Qlthuctap_VuThiHoaiThu

create table sinhvien(
	masv char(10) primary key,
	hotensv nvarchar(30),
	lop nvarchar(15),
)
insert into sinhvien
values  ('SV01','Nguyễn Minh Đức','D16CNPM1'),
		('SV02','Nguyễn Văn Sang','D16CNPM3'),
		('SV03','Nguyễn Thu Huyền','D16HTTMDT1'),
		('SV04','Phan Đình Anh','D16TTNT&TGMT'),
		('SV05','Trần Bảo Ngọc','D16QT&ANM')

create table giangvien(
	magv char(10) primary key,
	hoten nvarchar(30),
	sdt nvarchar(15),
)
insert into giangvien
values  ('GV01','Nguyễn Quỳnh Anh','0912107843'),
		('GV02','Bùi Khánh Linh','0912107859'),
		('GV03','Nguyễn Khánh Tùng','0912107878'),
		('GV04','Phương Văn Cảnh','0912107845'),
		('GV05','Hoàng Thanh Tùng','0912107875')

create table huongdan(
	magv char(10) foreign key references giangvien(magv),
	masv char(10) foreign key references sinhvien(masv),
	tendt nvarchar(70),
	noithuctap nvarchar(30),
	primary key(magv, masv)
)
insert into huongdan
values ('GV05', 'SV05','Xây dựng hệ thống cảnh báo email spam','Netnam'),
		('GV04','SV02','Xây dựng hệ thống tư vấn khách hàng','FSI'),
		('GV03','SV01','Xây dựng App học TA','FPT Software'),
		('GV02','SV04','Khai phá quan điểm người dùng sản phẩmSamSung','Samsung'),
		('GV01','SV03','Xây dựng hệ thống AI hỗ trợ bán hàng online','FSI')

--2) Hãy đưa ra toàn bộ thông tin trong danh sách thực tập bao gồm: 
	--họ tên của sinh viên, lớp, tên giảng viên hướng dẫn và nơi thực tập
	select hotensv, lop, hoten, noithuctap
	from sinhvien, giangvien, huongdan
	where sinhvien.masv = huongdan.masv
	and giangvien.magv = huongdan.magv
--3) Hãy viết default cho cột Nơi thực tập là “chua co noi thuc tap” nếu nơi thực tập bỏ trống.
	
--4) Viết thủ tục nhập vào mã sinh viên sẽ hiển thị đầy đủ tên giảng viên hướng dẫn.
	create proc hienthi @masv char(10)
	as 
		if @masv is null
		begin
			print 'hay nhap ma sinh vien'
			return 
			end
		else
			begin
			select hoten
			from giangvien, huongdan, sinhvien
			where giangvien.magv = huongdan.magv
			and sinhvien.masv = huongdan.masv
			and huongdan.masv = @masv
			end
	exec hienthi 'SV02'
--5) Hãy đưa ra thông tin: họ tên sinh viên, tên đề tài, giảng viên hướng dẫn của sinh viên đi thực tập tại FSI
	select hotensv, tendt, hoten
	from sinhvien, giangvien, huongdan
	where sinhvien.masv = huongdan.masv
	and huongdan.magv = giangvien.magv
	and noithuctap = 'FSI'
--6) Hãy viết default cho cột Nơi thực tập là “chua co noi thuc tap” nếu nơi thực tập bỏ trống.
	--GIỐNG CÂU 3
--7) Viết thủ tục nhập vào mã giảng viên sẽ hiển thị đầy đủ tên sinh viên mà giảng viên đó hướng dẫn.
	create proc hienthi2 @magv char(10)
	as
		if @magv is null
		begin 
			print 'Nhap ma giang vien'
			return 
		end
		else
			begin 
			select hotensv
			from sinhvien, giangvien, huongdan
			where sinhvien.masv = huongdan.masv
			and huongdan.magv = giangvien.magv
			and huongdan.magv = @magv
		end
	exec hienthi2 'GV03'
--8) Hãy đưa ra thông tin: họ tên sinh viên, tên đề tài, giảng viên hướng dẫn của sinh viên đi thực tập tại Netnam
	select hotensv, tendt, hoten
	from sinhvien, giangvien, huongdan
	where sinhvien.masv = huongdan.masv
	and huongdan.magv = giangvien.magv
	and noithuctap = 'Netnam'
--9) Hãy hiển thị tên, điệm thoại của giảng viên hướng dẫn sinh viên thực tập tại Samsung.
	select hoten, sdt
	from giangvien, huongdan
	where giangvien.magv = huongdan.magv
	and noithuctap = 'Samsung'
--10) Hãy đưa ra thông tin: họ tên sinh viên và giảng viên hướng dẫn có tên đề tài “Xây dựng App học TA”.
	select hotensv, hoten
	from sinhvien, giangvien, huongdan
	where sinhvien.masv = huongdan.masv
	and giangvien.magv = huongdan.magv
	and tendt = 'Xây dựng App học TA'
--11) Hãy cho biết số sinh viên của lớp D16CNPM1 đi thực tập.
	select count(*) as sosv
	from sinhvien, huongdan
	where sinhvien.masv = huongdan.masv
	and lop = 'D16CNPM1'
--12) Viết thủ tục nhập vào mã sinh viên sẽ hiển thị đầy đủ tên, điện thoại của giảng viên hướng dẫn.
	create proc hienthi3 @masv char(10)
	as
		if @masv is null
		begin 
			print 'Nhap ma sinh vien'
			return 
		end
		else
		begin
			select hoten, sdt
			from giangvien, sinhvien, huongdan
			where giangvien.magv = huongdan.magv
			and huongdan.masv = sinhvien.masv
			and huongdan.masv = @masv
		end
	exec hienthi3 'SV03'
--13) Hãy đưa ra thông tin: họ tên sinh viên, lớp và giảng viên hướng dẫn có tên đề tài “Xây dựng Appfood”.
	select hotensv, lop, hoten
	from sinhvien, giangvien, huongdan
	where sinhvien.masv = huongdan.masv
	and huongdan.magv = giangvien.magv
	and tendt = 'Xây dựng hệ thống AI hỗ trợ bán hàng online'
--14) Hãy viết view vw_HT_SV hiển thị họ tên của sinh viên và giảng viên hướng dẫn
	create view vw_HT_SV
	as
		select hotensv, hoten
		from sinhvien, giangvien, huongdan
		where sinhvien.masv = huongdan.masv
		and giangvien.magv = huongdan.magv

	select * from vw_HT_SV
--15) Sinh viên Nguyễn Minh An, Lớp D16CNPM6 mới được bổ sung vào danh sách,hãy cập nhật lại dữ liệu cho bảng SinhVien.
	insert into sinhvien
	values ('SV06','Nguyễn Minh An','D16CNPM6')
	select * from sinhvien
--16) Hãy đưa ra họ tên các sinh viên mà giảng viên Bùi Khánh Linh hướng dẫn.
	select hotensv
	from sinhvien, giangvien, huongdan
	where sinhvien.masv = huongdan.masv
	and giangvien.magv = huongdan.magv
	and hoten = 'Bùi Khánh Linh'
--17) Sinh viên Nguyễn Thị Huyền đổi nơi thực tập sang công ty Viettel. Hãy cập nhật lại thông tin cho sinh viên này.
	update huongdan
	set noithuctap = 'Viettel'
	from sinhvien, huongdan
	where sinhvien.masv = huongdan.masv
	and hotensv = 'Nguyễn Thu Huyền'

	select huongdan.* from huongdan, sinhvien where sinhvien.masv = huongdan.masv and hotensv = 'Nguyễn Thu Huyền'
--18) Hãy viết view vw_HT_GV hiển thị họ tên của giảng viên và sinh viên giảng viên đó hướng dẫn
	--khi biết mã giảng viên là “GV02”.
	create view vw_HT_GV
	as
		select hoten, hotensv
		from sinhvien, giangvien, huongdan
		where sinhvien.masv = huongdan.masv
		and giangvien.magv = huongdan.magv
	select * from vw_HT_GV
--19) Hãy backup cơ sở dữ liệu sang ổ đĩa khác trong máy tính.
	backup database Qlthuctap_VuThiHoaiThu to disk = 'D:\bai1.bak'


BÀI 2:
create database Quanlybanhang_VuThiHoaiThu
use Quanlybanhang_VuThiHoaiThu

--HANGHOA (Mahang, Tenhang, Donvitinh, Soluong)
create table hanghoa(
	Mahang char(10) primary key,
	Tenhang nvarchar(50),
	donvitinh nvarchar(30),
	soluong int,
) 
insert into hanghoa
values  ('MH01','Hàng 01', 'Chiếc', 5),
		('MH02','Hàng 02', 'Bộ', 10),
		('MH03','Hàng 03', 'Chiếc', 4),
		('MH04','Hàng 04', 'Cái', 6),
		('MH05','Hàng 05', 'Chiếc', 5),
		('MH06','Hàng 06', 'Chiếc', 12)
--HOADON (MaHD, NgayHD, Tienban, Giamgia, Thanhtoan, nguoiban)
create table hoadon(
	MaHD char(10) primary key,
	NgayHD date,
	Tienban float,
	Giamgia float,
	Thanhtoan float,
	nguoiban nvarchar(30),
)
insert into hoadon
values  ('HD01','2/2/2022',4000, 0.5, 2000, 'Tran Thi A'),
		('HD02','2/3/2022',4000, 0.5, 2000, 'Tran Thi A'),
		('HD03','3/2/2022',5000, 0.5, 2000, 'Tran Thi B'),
		('HD04','4/4/2022',3000, 0.5, 1000, 'Tran Thi A'),
		('HD07','1/10/2022',4000, 0.5, 2000, 'Tran Thi D')
--CTHOADON (MaHD, Mahang, Soluong, Dongia)
create table cthoadon(
	MaHD char(10) foreign key references hoadon(MaHD),
	Mahang char(10) foreign key references hanghoa(Mahang),
	Soluong int,
	Dongia float,
	primary key(MaHD, Mahang),
)
insert into cthoadon
values	('HD01','MH01',2, 5000),
		('HD01','MH04',1, 7000),
		('HD02','MH02',3, 8000),
		('HD03','MH03',4, 6000),
		('HD03','MH02',3, 9000),
		('HD04','MH01',5, 5000)

--2) Hiển thị thông tin các mặt hàng có số lượng >10 đơn vị tính.
	select * from hanghoa
	where soluong > 10
--3) Tạo bổ sung ràng buộc Default cho cột NgayHD là ngày hiện tại.
	create default def_ngayHD
	as
		getdate()
	exec sp_bindefault 'def_ngayHD','HoaDon.NgayHD'

--4) Tạo trigger cập nhật lại số lượng hàng trong bảng HANGHOA mỗi khi hàng được bán.
	create trigger capnhat on cthoadon
	for insert
	as
		begin
			declare @sl int, @mahang char(10)
			set @sl = (select soluong from inserted)
			set @mahang = (select mahang from inserted)
			update hanghoa
			set soluong = soluong - @sl
			where mahang = @mahang
		end

--5) Hiển thị số tiền Thanh toán của hóa đơn có mã ‘HD01’
	select Thanhtoan from hoadon
	where MaHD = 'HD01'
--6) Tạo bổ sung ràng buộc Default cho cột Tienban bằng 0
	create default def_tienban
	as
		0
	exec sp_bindefault 'def_tienban','hoadon.tienban'
--7) Tạo trigger cập nhật lại tiền bán của mỗi hóa đơn khi thêm mặt hàng vào bảng
	--CTHOADON. Biết công thức tính Tienban = Sum(Soluong*Dongia)
	create trigger cn_tienban on cthoadon
	for insert
	as
		update hoadon
		set tienban = (select sum(soluong * dongia)
						from cthoadon
						where cthoadon.MaHD = hoadon.MaHD
						group by cthoadon.MaHD)
--8) Hiển thị thông tin các hóa đơn có tiền thanh toán nhỏ nhất.
	select * from hoadon
	where Thanhtoan = (select min(Thanhtoan) from hoadon)
--9) Tạo bổ sung ràng buộc Rule cho cột Soluong của bảng Hanghoa nhận giá trị lớn hơn 0.
	create rule re_soluong
	as
		@soluong > 0
	exec sp_bindrule 're_soluong','hanghoa.soluong'
--10) Tạo Trigger cập nhật lại số tiền cần Thanhtoan khi cột Giamgia thay đổi. Biết công
	--thức tính số tiền cần thanh toán trên mỗi hóa đơn là: Thanhtoan=Tienban-Tienban*Giamgia
	create trigger cn_thanhtoan on hoadon
	for update
	as
		update hoadon
		set Thanhtoan = Tienban - Tienban*Giamgia
--11) Hiển thị thông tin các mặt hàng có đơn vị tính là ‘Chiếc’.
	select * from hanghoa
	where donvitinh = 'Chiếc'
--12) Tạo bổ sung ràng buộc Rule cho cột Donvitinh chỉ nhận các giá trị: Chiếc, Bộ
	create rule ru_donvitinh
	as
		@donvitinh in ('Bộ','Chiếc')
	exec sp_bindrule 'ru_donvitinh','hanghoa.donvitinh'
--13) Tạo trigger cập nhật lại tiền bán của mỗi hóa đơn khi xóa mặt hàng được bán trong
	--bảng CTHOADON. Biết công thức Tienban=Sum(Soluong*Dongia)
	create trigger capnhat_tienban on cthoadon
	for delete
	as
		update hoadon
		set Tienban = ( select sum(Soluong * Dongia)
						from hoadon, cthoadon
						where hoadon.MaHD = cthoadon.MaHD
						group by cthoadon.MaHD)
--14) Hiển thị Mã hàng, Số lượng hàng được bán bởi hóa đơn có mã là ‘HD05’
	select Mahang, Soluong
	from cthoadon
	where MaHD = 'HD05'
--15) Tạo view lưu thông tin các mặt hàng chưa được bán tại cửa hàng. Thông tin gồm có: Mã hàng, Tên hàng, Đơn vị tính.
	create view view_mathang
	as
		select Mahang, tenhang, donvitinh
		from hanghoa
		where Mahang not in (select Mahang from cthoadon)

--16) Tạo trigger cập nhật lại tiền bán của mỗi hóa đơn khi chỉnh sửa lại thông tin mặt
	--hàng được bán trong bảng CTHOADON. Biết công thức tính Tienban=Sum(Soluong*Dongia)
	create trigger cntienban on cthoadon
	for insert
	as
		update hoadon
		set Tienban = ( select sum(Soluong * Dongia)
						from cthoadon
						where hoadon.MaHD = cthoadon.MaHD
						group by cthoadon.MaHD)
--17) Hiển thị Tiền bán của hóa đơn có mã là ‘HD07’
	select Tienban
	from hoadon
	where MaHD = 'HD07'
--18) Hiển thị thông tin mặt hàng được bán với số lượng nhiều nhất tại cửa hàng.
		--Thông tin hiển thị gồm có: Mã hàng, Tên hàng, Tổng số lượng hàng được bán.
		select cthoadon.Mahang, Tenhang, sum(cthoadon.Soluong) as tongsoluong
		from hanghoa, cthoadon
		where hanghoa.Mahang = cthoadon.Mahang
		group by cthoadon.Mahang, Tenhang
		having sum(cthoadon.Soluong) >= all(select sum(Soluong) from cthoadon group by Mahang)
--19) Tạo thủ tục hiển thị thông tin của hàng hóa khi biết mã hàng.
	create proc hienthi @mahang char(10)
	as
		select * from hanghoa
		where Mahang = @mahang
	exec hienthi 'MH03'
--20) Hiển thị mã hóa đơn được lập trong năm 2022
	select MaHD from hoadon
	where year(NgayHD) = 2022
--21) Hiển thị thông tin mặt hàng được bán với số lượng ít nhất tại cửa hàng. 
		--Thông tin hiển thị gồm có: Mã hàng, tên hàng, tổng số lượng hàng được bán.
	select cthoadon.Mahang, Tenhang, sum(cthoadon.Soluong) as tongsl
	from hanghoa, cthoadon
	where cthoadon.Mahang = hanghoa.Mahang
	group by cthoadon.Mahang, Tenhang
	having sum(cthoadon.Soluong) <= all(select sum(Soluong) from cthoadon group by Mahang)
--22) Tạo thủ tục hiển thị thông tin của hóa đơn khi biết mã hóa đơn.
	--GIỐNG CÂU 19.
--23) Backup cơ sở dữ liệu sang ổ đĩa khác
	backup database Quanlybanhang_VuThiHoaiThu to disk = 'D:\bai2.bak'
	

BÀI 3:

create database Quanlynhanvien_VuThiHoaiThu
use Quanlynhanvien_VuThiHoaiThu

--Chucvu(macv, tencv, hesopc)
create table chucvu(
	macv char(10) primary key,
	tencv nvarchar(40),
	hesopc float,
)
insert into chucvu
values  ('CV1','Chức vụ 1',3000),
		('CV2','Chức vụ 2',1000),
		('CV3','Chức vụ 3',300),
		('CV4','Chức vụ 4',2000),
		('CV5','Chức vụ 5',3500)
--Phong(maph, tenph, diachiphong, dienthoaiphong)
create table phong(
	maph char(10) primary key,
	tenph nvarchar(40),
	diachiphong nvarchar(40),
	dienthoaiohong nvarchar(12),
)
insert into phong
values  ('PH01','Phòng 1','Hà Nội','0987654321'),
		('PH02','Phòng 2','Hà Nội','0987654322'),
		('PH03','Phòng 3','Hà Nội','0987654312'),
		('PH04','Phòng 4','Hà Nội','0987654333'),
		('PH05','Phòng 5','Hà Nội','0987654123'),
		('PH06','Phòng 1','Nhà A','0987654321')
--Nhanvien(manv, tennv, gioitinh, diachi, hsluong, (macv, maph), Luong, Thuclinh)
create table nhanvien(
	manv char(10),
	tennv nvarchar(30),
	gioitinh nvarchar(5),
	diachi nvarchar(30),
	hsluong float,
	macv char(10) foreign key references chucvu(macv),
	maph char(10) foreign key references phong(maph),
	luong float,
	thuclinh float,
	primary key(manv, macv, maph)
)
insert into nhanvien
values	('nv01','Nhân viên 1','Nữ','Hà Nội',15,'CV1','PH01',20000,19000),
		('nv01','Nhân viên 1','Nữ','Hà Nội',14,'CV3','PH02',23000,18000),
		('nv02','Nhân viên 2','Nam','Hà Nội',15,'CV1','PH03',50000,39000),
		('nv03','Nhân viên 3','Nữ','Hà Nội',16,'CV5','PH05',10000,9000),
		('nv03','Nhân viên 3','Nữ','Hà Nội',10,'CV1','PH01',30000,22000),
		('nv04','Nhân viên 5','Nam','Hà Nội',15,'CV4','PH04',18000,10000)

--2) Hiển thị địa chỉ của phòng có tên là ‘Phòng 4’
	select diachiphong
	from phong
	where tenph = 'Phòng 4'
--3) Tạo view lưu thông tin của phòng ‘Phòng 1’. Thông tin gồm có: Mã nhân viên,tên nhân viên, tên phòng.
	create view tt_phong
	as
		select manv, tennv, tenph
		from nhanvien, phong
		where nhanvien.maph = phong.maph
		and tenph = 'Phòng 1'
	select * from tt_phong
--4) Tạo Trigger tính tiền lương cho nhân viên mỗi khi hệ số lương thay đổi.
	--Biết tiền lương được tính theo công thức: Luong = Hsluong * 1230000
	create trigger tinh_luong on nhanvien
	for update
	as
		update nhanvien
		set luong = hsluong * 1230000
		from nhanvien
--5) Hiển thị thông tin những nhân viên có địa chỉ ở ‘Hải Phòng’. 
	--Thông tin hiển thị gồm có: Mã nhân viên, tên nhân viên, địa chỉ.
	select manv, tennv, diachi
	from nhanvien
	where diachi = 'Hà Nội'
--6) Tạo bổ sung ràng buộc Default cho cột Thuclinh bằng 0
	create default def_thuclinh
	as 
		0
	exec sp_bindefault 'def_thuclinh','nhanvien.thuclinh'
--7) Tạo Trigger tính tiền thực lĩnh cho nhân viên mỗi khi hệ số phụ cấp thay đổi. 
	--Biết thực lĩnh được tính theo công thức: Thuclinh=Luong + Luong * Hesopc
	create trigger tienthuclinh on nhanvien
	for insert
	as
		update nhanvien
		set thuclinh = luong + luong * hesopc
		from nhanvien, chucvu
		where nhanvien.macv = chucvu.macv

	drop trigger tienthuclinh
--8) Hiển thị thông tin những nhân viên thuộc phòng có mã ‘PH05’. 
	--Thông tin hiển thị gồm có: Mã nhân viên, tên nhân viên, địa chỉ của nhân viên.
	select manv, tennv, diachi
	from nhanvien
	where maph = 'PH05'
--9) Tạo bổ sung ràng buộc Default cho cột Diachi là ‘Chưa xác định’
	create default def_diachi
	as
		'Chưa xác định'
	exec sp_bindefault 'def_diachi','nhanvien.diachi'
--10) Tạo Trigger tính tiền lương cho nhân viên .
	--Biết tiền lương được tính theo công thức: Luong = Hsluong * 1230000
	--GIỐNG CÂU 10 
--11) Hiển thị thông tin các phòng có địa chỉ ở ‘Nhà A’. Thông tin hiển thị gồm có: Mã phòng, Tên phòng.
	select maph, tenph
	from phong
	where diachiphong = 'Nhà A'
--12) Tạo bổ sung ràng buộc Rule cho cột HesoPC chỉ nhận giá trị từ 0 đến 0.6
	create rule ru_hesopc
	as
		@hesopc between 0 and 0.6
	exec sp_bindrule 'ru_hesopc','chucvu.hesopc'
--13) Tạo thủ tục hiển thị Tên phòng, Tổng số nhân viên của phòng khi biết Mã phòng = 'PH01'
	select tenph, count(*)
	from phong, nhanvien
	where phong.maph = nhanvien.maph
	and nhanvien.maph = 'PH01'
	group by tenph
--14) Hiển thị thông tin những nhân viên không thuộc phòng ‘PH02’. 
	--Thông tin hiển thị gồm có: Mã nhân viên, Tên nhân viên, Mã phòng.
	select manv, tennv, maph
	from nhanvien
	where manv not in (select manv from nhanvien where maph = 'PH02')
--15) Hiển thị thông tin những nhân viên có hệ số lương thấp nhất.
	--Thông tin hiển thị gồm có: Mã nhân viên, Tên nhân viên, Hệ số lương.
	select manv, tennv, hsluong
	from nhanvien
	where hsluong = (select min(hsluong) from nhanvien)
--16) Tạo thủ tục hiển thị Mã nhân viên, Tên nhân viên, Tên chức vụ khi biết Mã chức vụ = 'CV1'
	create proc hienthi @macv char(10)
	as
		select manv, tennv, tencv
		from nhanvien, chucvu
		where nhanvien.macv = chucvu.macv
		and nhanvien.macv = @macv
	exec hienthi 'CV1'
--17) Hiển thị thông tin các phòng không thuộc ‘Nhà A’. Thông tin gồm có: Mã phòng, Tên phòng, Điện thoại phòng.
	select maph, tenph, dienthoaiohong
	from phong
	where maph not in (select maph from phong where diachiphong = 'Nhà A')
--18) Tạo view lưu thông tin nhân viên của phòng 'phòng 5’. Thông tin lưu gồm có: Mã nhân viên, Tên nhân viên, Tên phòng.
	create view tt_nv
	as
		select manv, tennv, tenph
		from nhanvien, phong
		where nhanvien.maph = phong.maph
		and tenph = 'Phòng 5'
	select * from tt_nv
--19) Tạo thủ tục hiển thị Mã nhân viên, Tên nhân viên, Tên phòng khi biết Mã phòng = 'PH05'
	create proc hienthi_tt @maph char(10)
	as
		select manv, tennv, tenph
		from phong, nhanvien
		where phong.maph = nhanvien.maph
		and nhanvien.maph = @maph
	exec hienthi_tt 'PH05'
--20) Backup cơ sở dữ liệu sang ổ đĩa khác.
	backup database Quanlynhanvien_VuThiHoaiThu to disk = 'D:\bai3.bak'

BÀI 4:

create database Quanlydulich_VuThiHoaiThu
use Quanlydulich_VuThiHoaiThu

--DIADIEM(MADD, TENDD,TP)
create table diadiem(
	madd char(10) primary key,
	tendd nvarchar(40),
	tp nvarchar(30),
)
insert into diadiem 
values  ('DD01','Ba Vì','Hà Nội'),
		('DD02','Văn Miếu','Hà Nội'),
		('DD03','Lăng Bác','Hà Nội'),
		('DD04','Hồ Tây','Hà Nội'),
		('DD05','Nha Trang','Khánh Hòa')
--CHUYENDI(MACD, TENCD, NGKH, NGKT, KHDK)
create table chuyendi(
	macd char(10) primary key,
	tencd nvarchar(40),
	ngkh date,
	ngkt date,
	khdk int,
)
insert into chuyendi
values  ('CD01','Chuyến đi 1','9/9/2022','10/10/2022',20),
		('CD02','Chuyến đi 2','8/9/2022','1/10/2022',40),
		('CD03','Chuyến đi 3','9/8/2022','3/10/2022',30),
		('CD04','Chuyến đi 4','1/9/2022','12/9/2022',50),
		('CD05','Chuyến đi 5','9/11/2022','10/10/2022',5)
--CTIETCD(MACD, MADD, SNLUU)
create table ctietcd(
	macd char(10) foreign key references chuyendi(macd),
	madd char(10) foreign key references diadiem(madd),
	snluu int,
)
insert into ctietcd
values  ('CD01','DD01',10),
		('CD02','DD01',30),
		('CD01','DD04',15),
		('CD03','DD03',22),
		('CD04','DD05',18),
		('CD05','DD05',21)

--2) Hiển thị các địa điểm du lịch (MADD, TENDD) của chuyến đi có mã ‘CD01’.
	select diadiem.madd, tendd
	from diadiem, ctietcd
	where diadiem.madd = ctietcd.madd
	and macd = 'CD01'
--3) Tạo View hiển thị thông tin Tên chuyến đi (TENCN) và Số lượng địa điểm của các chuyến đi đó.
	create view ht_tt_cd
	as
		select tencd, count(*) as soluongdd
		from chuyendi, ctietcd
		where chuyendi.macd = ctietcd.macd
		group by tencd
	select * from ht_tt_cd
--4) Viết trigger thực hiện kiểm tra ngày khởi hành (NGKH) và ngày kết thúc 
	--(NGKT) trên bảng chuyến đi khi thêm hay sửa phải thỏa mãn lớn hơn hoặc bằng ngày hiện tại.
	create trigger kiemtra on chuyendi
	for insert, update 
	as
		begin
		declare @ngaykh date = (select ngkh from inserted)
		declare @ngaykt date = (select ngkt from inserted)
		if(@ngaykh > getdate() and @ngaykt > getdate())
			begin
				print 'Nhap lai ngay khoi hanh va ket thuc'
				rollback tran
			end
		end
--5) Hiển thị số ngày lưu lại lớn nhất, nhỏ nhất qua các điểm du lịch của chuyến đi có mã ‘CD01’.
	select max(snluu) as songayluumax, min(snluu) as songayluumin
	from chuyendi, ctietcd
	where chuyendi.macd = ctietcd.macd
	and ctietcd.macd = 'CD01'
--6) Tạo View hiển thị thông tin của các chuyến đi bao gồm: 
	--Mã chuyến đi, Tên chuyến đi (MACD,TENCD) có ngày khởi hành (NGKH) trong năm 2022.
	create view ht_tt_chuyendi
	as
		select macd, tencd
		from chuyendi
		where year(ngkh) = 2022
	select * from ht_tt_chuyendi
--7) Tạo thủ tục hiển thị thông tin của địa điểm khi biết mã địa điểm (MaDD) = 'DD05'
	create proc hienthi @madd char(10)
	as
		select * from diadiem
		where madd = @madd
	exec hienthi 'DD05'
--8) Hiển thị mã chuyến đi, mã địa điểm và số ngày lưu (MACD,MADD,SNLUU)với điều kiện có số ngày lưu lại (SNLUU ) nhỏ nhất.
	select macd, madd, snluu
	from ctietcd
	where snluu = (select min(snluu) from ctietcd)
--9) Tạo bổ sung ràng buộc Defaul cho cột SNLUU bằng 0.
	create default def_snluu
	as
		0
	exec sp_bindefault 'def_snluu','ctietcd.snluu'
--10) Tạo thủ tục hiển thị thông tin của chuyến đi khi biết mã chuyến đi(MaCD) = 'CD02'
	create proc hienthi_tt @macd char(10)
	as
		select * from chuyendi
		where macd = @macd
	exec hienthi_tt 'CD02'
--11) Hiển thị thông tin của các chuyến đi bao gồm:  (MACD, TENCD) có ngày khởi hành (NGKH) là ngày 2022/9/9
	select macd, tencd from chuyendi
	where ngkh = '09-09-2022'
--12) Tạo bổ sung ràng buộc Defaul cho cột NGKH bằng ngày hiện tại.
	create default def_ngkh
	as
		getdate()
	exec sp_bindefault 'def_ngkh','chuyendi.ngkh'
--13) Tạo thủ tục hiển thị tên chuyến đi (TENCD) và số lượng địa điểm của chuyến đi khi biết mã chuyến đi (MACD) = 'CD01'.
	create proc hienthi_cd @macd char(10)
	as
		select tencd, count(*) as soluongdd
		from chuyendi, ctietcd
		where chuyendi.macd = ctietcd.macd
		and ctietcd.macd = @macd
		group by tencd
	exec hienthi_cd 'CD01'
--14) Hiển thị thông tin của các chuyến đi bao gồm: Mã chuyến đi, Tên chuyến đi (MACD,TENCD) có số khách dự kiến nhiều nhất.
	select macd, tencd
	from chuyendi
	where khdk = (select max(khdk) from chuyendi)
--15) Viết trigger thực hiện kiểm tra số ngày lưu lại (SNLUU) trên bảng CTIETCD khi thêm hay sửa phải thỏa mãn SNLUU>=0.
	create trigger kiemtra_snluu on ctietcd
	for insert, update
	as
		begin
		declare @snluu int = (select snluu from inserted)
		if(@snluu < 0)
			begin
				print 'Nhap lai ngay luu lai'
				rollback tran
			end
		end

	drop trigger kiemtra_snluu
--16) Hiển thị thông tin của các địa điểm bao gồm: Mã địa điểm, Tên địa điểm (MADD,TENDD) thuộc thành phố ‘hà nội’.
	select madd, tendd
	from diadiem
	where tp = 'Hà Nội'
--17) Tạo bổ sung ràng buộc Rule cho cột NGKH,NGKT >= ngày hiện tại.
	create rule ru_ngay
	as 
		@ngay >= getdate()
	exec sp_bindrule 'ru_ngay','chuyendi.ngkh'
	exec sp_bindrule 'ru_ngay','chuyendi.ngaykt'
--18) Viết trigger thực hiện kiểm tra số khách đăng ký (KHDK) trên bảng CHUYENDI khi thêm hay sửa phải thỏa mãn KHDK>=5.
	create trigger kt on chuyendi
	for insert, update
	as
		begin
		declare @khdk int = (select khdk from inserted)
		if(@khdk < 5)
			begin 
			print 'So khach dang ki phai >= 5'
			rollback tran
			end
		end
--19) Backup cơ sở dữ liệu sang ổ đĩa khác.
	backup database Quanlydulich_VuThiHoaiThu to disk = 'D:\bai4.bak'

BÀI 5:

create database Quanlykhachsan_VuThiHoaiThu
use Quanlykhachsan_VuThiHoaiThu

--PHONG (MAPH, TENPH, DT, GIAPHONG)
create table phong(
	maph char(10) primary key,
	tenph nvarchar(40),
	dt float,
	giaphong float,
) 
insert into phong
values	('PH01','Phòng 1','23',10000),
		('PH02','Phòng 2','25',50000),
		('PH03','Phòng 3','15',30000),
		('PH04','Phòng 4','34',70000),
		('PH05','Phòng 5','25',90000),
		('PH06','Phòng 6','16',10000)
--KHACHHANG (MAKH, TENKH, DIACHI)
create table khachhang(
	makh char(10) primary key,
	tenkh nvarchar(40),
	diachi nvarchar(40),
)
insert into khachhang
values  ('KH01','Khách hàng 1','Hà Nội'),
		('KH02','Khách hàng 2','Hà Nam'),
		('KH03','Khách hàng 3','Thái Bình'),
		('KH04','Khách hàng 4','Hà Nội'),
		('KH05','Khách hàng 5','Hà Nội'),
		('KH06','Khách hàng 6','Hà Nội')
--THUEPHONG (MAHD, MAKH, MAPH, NGBD, NGKT,THANHTIEN)
create table thuephong(
	mahd char(10),
	makh char(10) foreign key references khachhang(makh),
	maph char(10) foreign key references phong(maph),
	ngaybd date,
	ngaykt date,
	thanhtien float,
	primary key(mahd, makh),
)
insert into thuephong
values  ('HD01','KH01','PH01','4/4/2022','12/4/2022',12000),
		('HD01','KH02','PH03','9/9/2022','12/10/2022',18000),
		('HD02','KH02','PH02','4/4/2022','12/4/2022',12000),
		('HD03','KH03','PH04','4/4/2022','12/4/2022',12000),
		('HD02','KH01','PH05','4/4/2022','12/4/2022',12000),
		('HD04','KH05','PH05','4/4/2022','12/4/2022',12000),
		('HD01','KH04','PH01','4/4/2022','12/4/2022',12000)
--2) Hiển thị thông tin của các khách hàng (MAKH,TENKH,DIACHI) chưa bao giờ thuê phòng.
	select khachhang.makh, tenkh, diachi
	from khachhang
	where makh not in (select makh from thuephong)
--3) Tạo bổ sung ràng buộc Defaul cho cột THANHTIEN bằng 0.
	create default def_thanhtien
	as
		0
	exec sp_bindefault 'def_thanhtien','thuephong.thanhtien'
--4) Tạo thủ tục hiển thị thông tin của các Khách hàng (MAKH,TENKH, DIACHI) 
	--khi biết mã phòng (MAPH = PH01) và ngày bắt đầu thuê phòng(NGBD=4/4/2022)
	create proc hienthi @maph char(10), @ngbd date
	as
		select khachhang.* from khachhang,thuephong
		where khachhang.makh = thuephong.makh
		and  maph = @maph
		and ngaybd = @ngbd
	exec hienthi 'PH01', '4/4/2022'
--5) Hiển thị thông tin của các phòng (MAPH, TENPH, GIAPHONG) chưa bao giờ được khách hàng thuê.
	select maph, tenph, giaphong
	from phong
	where maph not in (select maph from thuephong)
--6) Tạo bổ sung ràng buộc Rule cho cột GIAPHONG >=5.
	create rule ru_giaphong
	as
		@giaphong >= 5
	exec sp_bindrule 'ru_giaphong','phong.giaphong'
--7) Tạo thủ tục hiển thị thông tin của các PHONG (MAPH, TENPH, DT, GIAPHONG) có ít khách hàng thuê nhất.
	create proc hienthi_tt
	as
		select phong.maph, tenph, dt, giaphong from phong, thuephong
		where phong.maph = thuephong.maph
		group by phong.maph, tenph, dt, giaphong
		having count(*) <= all(select count(*) from thuephong group by maph )
	exec hienthi_tt
	drop proc hienthi_tt
--8) Hiển thị thông tin của những khách hàng (MAKH,TENKH,DIACHI) đã thuê phòng có mã phòng(MAPH) =‘PH02’.
	select khachhang.* 
	from khachhang, thuephong
	where maph = 'PH02'
	and khachhang.makh = thuephong.makh
--9) Tạo bổ sung ràng buộc Defaul DIACHI là ‘CHUA XAC DINH’.
	create default def_diachi
	as
		'Chưa xác định'
	exec sp_bindefault 'def_diachi','khachhang.diachi'
--10) Tạo trigger thực hiện kiểm tra ngày bắt đầu (NGBD) và ngày kết thúc (NGKT) 
	--khi thêm hay sửa phải thỏa mãn lớn hơn hoặc bằng ngày hiện tại.
	create trigger kt on thuephong
	for insert, update
	as
		begin
		declare @ngbd date = (select ngaybd from inserted)
		declare @ngkt date = (select ngaykt from inserted)
		if(@ngbd >= getdate() and @ngkt >= getdate())
			begin
			print 'Nhap lai ngay bat dau va ngay ket thuc'
			rollback tran
			end
		end
--11) Hiển thị thông tin của các phòng (MAPH, TENPH, DT, GIAPHONG) do khách hàng có mã khách hàng (MAKH) = ‘KH02’ thuê.
	select phong.* from phong, thuephong
	where makh = 'KH02'
	and phong.maph = thuephong.maph
--12) Tạo View hiển thị thông tin của Khách hàng (TENKH) có địa chỉ ‘HA NOI’.
	create view ht_tt_kh
	as
		select tenkh
		from khachhang where diachi = 'Hà Nội'
	select * from ht_tt_kh
--13) Tạo Trigger tự động cập nhật thành tiền (THANHTIEN) mỗi khi thêm dữ liệu vào bảng THUEPHONG 
	--cho biết THANHTIEN=GIAPHONG*SONGAY.
	create trigger capnhat_thongtin on thuephong
	for insert,update
	as
		begin
			declare @maph char(10) = (select maph from inserted)
			declare @giaphong float = (select giaphong from phong where maph = @maph)
			update thuephong
			set thanhtien = (datediff(day, ngaybd, ngaykt)) * @giaphong
		end
	drop trigger cn_tt
--14) Hiển thị thông tin của các phòng (MAPH, TENPH, GIAPHONG) được thuê ngày bắt đầu(NGBD) là ngày ‘2022-09-10’.
	select phong.* from phong, thuephong
	where phong.maph = thuephong.maph
	and ngaybd = '2022-9-9'
--15) Tạo View hiển thị tên khách hàng(TENKH) và số lượng phòng mà các khách hàng đó thuê.
	create view ht_tenkh
	as
		select tenkh, count(*) as soluong
		from khachhang, thuephong
		where khachhang.makh = thuephong.makh
		group by tenkh
	select * from ht_tenkh
--16) Tạo thủ tục hiển thị thông tin của PHONG(MAPH, TENPH, DT, GIAPHONG) khi biết mã phòng (MAPH) = PH03
	create proc ht_thongtin @maph char(10)
	as
		select * from phong where maph = 'PH03' and maph = @maph
	exec ht_thongtin 'PH03'
--17) Hiển thị thông tin của các PHONG (MAPH, TENPH, DT) có ngày thuê là 10 ngày.
	select phong.* from phong, thuephong
	where phong.maph = thuephong.maph
	and datediff(day, ngaybd, ngaykt) = 10
--18) Tạo View hiển thị thông tin của các phòng (MAPH, TENPH, DT, GIAPHONG) có giá phòng cao nhất.
	create view ht_thongtinphong
	as
		select * from phong
		where giaphong = (select max(giaphong) from phong)
	select * from ht_thongtinphong
--19) Tạo thủ tục xóa các PHONG chưa bao giờ được thuê
	create proc xoaphong
	as
		begin
		delete from phong
		where maph not in (select maph from thuephong)
		end
	exec xoaphong
--20) Hiển thị thông tin của những khách hàng (MAKH,TENKH,DIACHI) đã thuê phòng có mã phòng(MAPH) =‘PH02’.
	select khachhang.* from khachhang, thuephong
	where khachhang.makh = thuephong.makh
	and maph = 'PH02'
--21) Tạo View hiển thị tên khách hàng(TENKH) và số lượng phòng mà các khách hàng đó thuê.
	create view vw_ht_tt
	as
		select tenkh, count(*) as soluong
		from khachhang, thuephong
		where khachhang.makh = thuephong.makh
		group by tenkh
	select * from vw_ht_tt
--22) Tạo Trigger tự động cập nhật thành tiền (THANHTIEN) 
	--mỗi khi thêm dữ liệu vào bảng THUEPHONG cho biết THANHTIEN=GIAPHONG*SONGAY
	create trigger capnhat_thanhtien on thuephong
	for insert, update
	as
		begin 
			declare @maph char(10) = (select maph from inserted)
			declare @giaphong float = (select giaphong from phong where maph = @maph)
			update thuephong
			set thanhtien = (datediff(day, ngaybd, ngaykt)) * @giaphong
		end
--23) Backup cơ sở dữ liệu sang ổ đĩa khác.
	backup database Quanlykhachsan_VuThiHoaiThu to disk = 'D:\bai5.bak'

BÀI 6:

create database QLKH_VTHT
use QLKH_VTHT

create table giangvien(
	gv char(10) primary key,
	hoten nvarchar(30),
	diachi nvarchar(50),
	ngaysinh date, 
)
insert into giangvien
values  ('GV01','Lê Hoàn','Mỹ Đình, Hà Nội','10/10/1982'),
		('GV02','Phương Văn Cảnh','Nam Từ Liêm, Hà Nội','11/03/1986'),
		('GV03','Phạm Quang Huy','Đống Đa, Hà Nội','06/04/1990'),
		('GV04','Bùi Khánh Linh','Tây Hồ, Hà Nội','12/10/1993'),
		('GV05','Lê Trang Linh','Đống Đa, Hà Nội','10/10/1986')

create table detai(
	dt char(10) primary key,
	tendt nvarchar(50),
	cap nvarchar(30),
	kinhphi float,
)
insert into detai
values  ('DT01','Nhận dạng khuôn mặt','Nhà nước',800),
		('DT02','Tính toán lưới','Bộ',500),
		('DT03','An toàn thông tin','Bộ',370),
		('DT04','Xây dựng hệ thống eleaning','Trường',20)

create table thamgia(
	gv char(10) foreign key references giangvien(gv),
	dt char(10) foreign key references detai(dt),
	sogio int,
)
insert into thamgia
values  ('GV01','DT01',100),
		('GV01','DT02',80),
		('GV01','DT04',80),
		('GV02','DT01',120),
		('GV02','DT03',140),
		('GV03','DT03',150),
		('GV04','DT04',180)

--2) Đưa ra thông tin giảng viên có địa chỉ ở quận “Đống Đa”, sắp xếp theo thứ tự giảm dần của họ tên.
	select * from giangvien
	where diachi like 'Đống Đa,%'
	order by hoten DESC
--3) Tạo view có tên vw_DeTai_loc bao gồm tên đề tài, kinh phí. Và chỉ liệt kê những đề tài có kinh phí >300.
	create view vw_Detai_loc
	as
		select tendt, kinhphi
		from detai
		where kinhphi > 300
	select * from vw_Detai_loc
--4) Giảng viên có mã GV04 không tham gia bất kỳ đề tài nào nữa. Hãy xóa tất cả thông tin liên quan đến giảng viên này trong CSDL.
	delete from thamgia where gv = 'GV04'
	delete from giangvien where gv = 'GV04'
--5) Đưa ra danh sách gồm họ tên, địa chỉ, ngày sinh của giảng viên có tham gia vào đề tài “Tính toán lưới”.
	select hoten, diachi, ngaysinh
	from giangvien, thamgia, detai
	where giangvien.gv = thamgia.gv
	and detai.dt = thamgia.dt
	and tendt = 'Tính toán lưới'
--6) Tạo thủ tục hiển thị Tên đề tài của những đề tài có kinh phí nhỏ hơn số chỉ định, 
	--nếu không có thì hiển thị thông báo không có đề tài nào.
	create proc hienthi_tendt @kinhphi float
	as
		begin
		if exists (select tendt from detai where kinhphi < @kinhphi)
			begin
			select tendt
			from detai
			where kinhphi < @kinhphi
			end
		else 
			print 'Không có đề tai nào'
		end
	exec hienthi_tendt 100
--7) Giảng viên Nguyễn Khánh Tùng sinh ngày 08/09/1985 địa chỉ Đống Đa, Hà Nội mới tham gia nghiên cứu đề tài khoa học. 
	--Hãy thêm thông tin giảng viên này vào bảng GiangVien.
	insert into giangvien
	values ('GV06','Nguyễn Khánh Tùng','Đống Đa, Hà Nội','09/08/1985')
--8) Đưa ra danh sách gồm họ tên, địa chỉ, ngày sinh của giảng viên có tham gia vào 
	--đề tài “An toàn thông tin” hoặc “Nhận dạng khuôn mặt”.
	select hoten, diachi, ngaysinh
	from thamgia, giangvien, detai
	where thamgia.gv = giangvien.gv
	and detai.dt = thamgia.dt
	and tendt = 'Nhận dạng khuôn mặt'
--9) Tạo một Trigger để kiểm tra số giờ phải lớn hơn 30, nếu không thì hiển thị không nhập được.
	create trigger kiemtra on thamgia
	for insert, update
	as
		begin
		declare @sogio float = (select sogio from thamgia)
		if(@sogio < 30)
			begin
				print 'Không thể nhập'
				rollback tran
			end
		end
--10) Giảng viên Lê Hoàn mới chuyển về sống tại quận Cầu Giấy, Hà Nội. Hãy cập nhật thông tin này.
	update giangvien
	set diachi = 'Cầu Giấy, Hà Nội'
	where hoten = 'Lê Hoàn'

	select * from giangvien where hoten = 'Lê Hoàn'
--11) Cho biết thông tin giảng viên tham gia ít nhất 2 đề tài.
	select giangvien.gv, hoten, diachi, ngaysinh
	from giangvien, thamgia
	where giangvien.gv = thamgia.gv
	group by giangvien.gv, hoten, diachi, ngaysinh
	having count(*) >= 2
--12) Đưa ra mã giảng viên, tên giảng viên và tổng số giờ tham gia nghiên cứu khoa học của từng giảng viên.
	select giangvien.gv, hoten, sum(sogio) as tongsogio
	from thamgia, giangvien
	where thamgia.gv = giangvien.gv
	group by giangvien.gv, hoten
--13) Cho biết tên giảng viên tham gia ít đề tài nhất.
	select hoten
	from thamgia, giangvien
	where thamgia.gv = giangvien.gv
	group by hoten
	having count(dt) <= all(select count(*) from thamgia group by dt)
--14) Dùng view vw_DT để liệt kê tên những đề tài cấp Bộ
	create view vw_DT
	as
		select tendt
		from detai
		where cap = 'Bộ'
	select * from vw_DT
--15) Cho biết tên những giảng viên sinh trước năm 1987 và có tham gia đề tài “An toàn thông tin”.
	select hoten
	from giangvien, thamgia, detai
	where giangvien.gv = thamgia.gv
	and thamgia.dt = detai.dt
	and year(ngaysinh) < 1987
	and tendt = 'An toàn thông tin'
--16) Đề tài nào tốn nhiều kinh phí nhất?
	select * from detai
	where kinhphi = (select max(kinhphi) from detai)
--17) Cho biết tên và ngày sinh của giảng viên sống ở Mỹ Đình và tên các đề tài mà giảng viên này tham gia.
	select hoten, ngaysinh, tendt
	from detai, giangvien, thamgia
	where detai.dt = thamgia.dt
	and giangvien.gv = thamgia.gv
	and diachi like 'Mỹ Đình,%'
--18) Tạo View vw_HT để hiển thị thông tin của đề tài và giảng viên thực hiện biết mã đề tài là “DT02”
	create view vw_HT
	as
		select detai.*, giangvien.*
		from detai, giangvien, thamgia
		where detai.dt = thamgia.dt
		and giangvien.gv = thamgia.gv
		and detai.dt = 'DT02'
	select * from vw_HT
--19) Đề tài nào tốn ít kinh phí nhất?
	select *
	from detai
	where kinhphi = (select min(kinhphi) from detai)
--20) Đưa ra toàn bộ thông tin tên đề tài, giảng viên tham gia, kinh phí, số giờ, cấp.
	select tendt, hoten, kinhphi, sogio, cap
	from detai, thamgia, giangvien
	where detai.dt = thamgia.dt
	and giangvien.gv = thamgia.gv
--21) Tạo View vw_HT_GV để hiển thị thông tin của giảng viên và đề tài giảng viên thực hiện có mã giảng viên “GV03”
	create view vw_HT_GV
	as
		select giangvien.*, tendt
		from giangvien, detai, thamgia
		where giangvien.gv = thamgia.gv
		and detai.dt = thamgia.dt
		and thamgia.gv = 'GV03'
	select * from vw_HT_GV
--22) Hãy đưa ra thông tin của đề tài có Kinh phi nhỏ nhất.
	select detai.*
	from detai
	where kinhphi = (select min(kinhphi) from detai)
--23) Hãy thêm cột thành tiền cho bảng ThamGia.
	alter table thamgia
	add thanhtien float
--24) Viết Trigger cập nhật thành tiền cho cột thành tiền từ bảng ThamGia, cho biết thành tiền=SoGio*80000.
	alter trigger capnhat on thamgia
	for insert, update
	as
		begin
			declare @sogio float = (select sogio from inserted)
			declare @gv char(10) = (select gv from inserted)
			declare @dt char(10) = (select dt from inserted)
			declare @thanhtien float = @sogio * 80000
			update thamgia set thanhtien = @thanhtien where gv = @gv and dt = @dt
		end
	select * from thamgia
	update thamgia set sogio = 20 where gv = 'GV06' and dt = 'DT03'
--25) Hãy backup cơ sở dữ liệu sang ổ đĩa khác trong máy tính.
	backup database QLKH_VTHT to disk = 'D:\bai5.bak'
